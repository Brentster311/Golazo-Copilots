# Design Review: CALJACK-001

## Summary

Implement the foundational pygame window and main menu system for the California Jack card game. This establishes the application entry point, window management, and navigation framework that all subsequent stories will build upon.

---

## Problem Statement

There is no existing California Jack card game implementation in this workspace. Users need a way to launch the game, navigate to gameplay or help, and have a stable window framework. Without this foundation, no subsequent game features can be delivered.

---

## Business Case

### Why Now
- This is the first story in the dependency chain; all other stories (CALJACK-002 through CALJACK-006) are blocked until this is complete
- Establishes the technical foundation and project structure early

### Impact
- Enables development of full California Jack game
- Provides immediate visual feedback that project is progressing
- Validates pygame as the chosen framework

### KPIs
- Window launches successfully on Windows
- Menu buttons are clickable and respond
- Transition to placeholder screens works

---

## Stakeholders

| Role | Interest |
|------|----------|
| Project Owner | Playable California Jack game |
| Players | Intuitive game launch and navigation |
| Developer (future) | Clean foundation for AI integration |

---

## Functional Requirements

| ID | Requirement | Source |
|----|-------------|--------|
| FR-001 | Game launches a pygame window (1024x768) | AC #1 |
| FR-002 | Main menu displays "New Game" button | AC #2 |
| FR-003 | Main menu displays "Help" button | AC #3 |
| FR-004 | Clicking "New Game" transitions to game screen | AC #4 |
| FR-005 | Clicking "Help" transitions to help screen | AC #5 |

---

## Non-Functional Requirements

| ID | Requirement | Source |
|----|-------------|--------|
| NFR-001 | Window responds to close button | User Story |
| NFR-002 | Menu buttons respond within 100ms | User Story |
| NFR-003 | Code structured for future AI integration | CALJACK-002 dependency |

---

## Proposed Approach (High Level)

### Architecture

```
PythonApplication2/
├── main.py                 # Entry point, game loop
├── requirements.txt        # pygame dependency
├── game/
│   ├── __init__.py
│   ├── constants.py        # Window size, colors, fonts
│   ├── states/
│   │   ├── __init__.py
│   │   ├── base_state.py   # Abstract state class
│   │   ├── menu_state.py   # Main menu implementation
│   │   ├── game_state.py   # Placeholder for CALJACK-002
│   │   └── help_state.py   # Placeholder for CALJACK-006
│   └── ui/
│       ├── __init__.py
│       └── button.py       # Reusable button component
```

### State Machine Pattern
- Use a state machine to manage screens (Menu, Game, Help)
- Each state handles its own `update()`, `draw()`, and `handle_event()` methods
- Clean transitions between states
- Easily extensible for future screens (Game Over, etc.)

### Technology Stack
- **Python 3.x** (existing workspace)
- **Pygame 2.x** (per User Story assumption)

---

## Alternatives Considered

| Alternative | Pros | Cons | Decision |
|-------------|------|------|----------|
| Single file, no states | Simple | Hard to extend, spaghetti code | Rejected |
| **State machine pattern** | Clean separation, extensible | Slightly more upfront code | **Selected** |
| Scene manager library | Pre-built | Extra dependency | Rejected |

| Alternative | Pros | Cons | Decision |
|-------------|------|------|----------|
| Tkinter | Built-in | Poor for games | Rejected |
| **Pygame** | Game-focused, sprites | Requires install | **Selected** (per User Story) |

---

## Risks, Mitigations, Open Questions

### Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Pygame installation issues | Low | Medium | Document in requirements.txt, provide install instructions |
| Button click detection inaccurate | Low | Low | Use pygame Rect collision detection |
| Font rendering issues | Low | Low | Use pygame default font as fallback |

### Open Questions

| Question | Status |
|----------|--------|
| Exact button styling (colors, hover effects)? | **Assumption**: Simple solid buttons, no hover effects for MVP |
| Background color/image? | **Assumption**: Solid dark green (card table feel) |

---

## Dependencies

### Upstream
- None (this is the foundation story)

### Downstream
- CALJACK-002 (Game Setup) - needs game_state.py placeholder
- CALJACK-006 (Help Screen) - needs help_state.py placeholder

### External
- Pygame library (pip install)

---

## Migration / Rollout / Rollback Plan

### Rollout
1. Create project structure
2. Implement pygame window and game loop
3. Implement state machine
4. Implement main menu with buttons
5. Add placeholder states for Game and Help
6. Test locally

### Rollback
- Not applicable (greenfield development)
- If pygame proves unsuitable, entire approach would need revisiting

---

## Observability Plan

- None required for local game
- Console logging for development/debugging (state transitions)

---

## Test Strategy Summary

| Test Type | Scope | Approach |
|-----------|-------|----------|
| Unit | Button click detection | pytest with mock events |
| Unit | State transitions | pytest state machine tests |
| Integration | Full menu flow | Manual testing + potential pygame headless |
| Visual | UI renders correctly | Manual inspection |

Key test scenarios:
1. Window launches at correct size
2. Menu buttons are visible
3. Clicking "New Game" changes state
4. Clicking "Help" changes state
5. Window close works properly
