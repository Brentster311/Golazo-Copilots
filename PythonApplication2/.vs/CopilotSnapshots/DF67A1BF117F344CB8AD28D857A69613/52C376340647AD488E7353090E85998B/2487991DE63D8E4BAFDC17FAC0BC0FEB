# Role Decision Document: Retrospective (Second)

**Work Item**: CALJACK-002  
**Role**: Retrospective  
**Date**: 2025-01-XX  
**Trigger**: User explicitly requested retrospective for two process failures

---

## Issues Identified

### Issue 1: Retrospective Not Auto-Triggering for Process Failures

**Evidence**: 
- User reported visual bugs (suit symbols showing as "?", trump text garbled, button text overflow)
- These bugs violated acceptance criteria: "Cards visually distinguishable by suit and rank"
- Copilot did NOT automatically trigger Retrospective role
- User had to explicitly ask why Retrospective didn't trigger

**Root Cause**:
The `.github/copilot-instructions.md` lists when Retrospective triggers but does NOT include:
- **User-reported bugs after DoD was marked complete**
- **Visual/UI defects discovered post-completion**

The trigger conditions are passive (waiting for explicit request) rather than active (detecting failures).

---

### Issue 2: Developer Role Lacks UI Verification with Project Owner

**Evidence**:
- Developer role marked DoD complete without visual verification
- Visual bugs were only discovered when Project Owner ran the application
- No instruction exists for Developer to collaborate with Project Owner on UI verification

**Root Cause**:
- Developer role instructions focus on automated tests
- No mention of UI/visual verification for UI-related stories
- No collaboration step with Project Owner for visual acceptance

---

## Proposed Changes

### Change 1: Add Auto-Trigger for Post-Completion Defects

**File**: `.github/copilot-instructions.md`

**Add new section after "Completion rule":**

```markdown
---

## Retrospective auto-trigger rules

The Retrospective role MUST be automatically triggered when ANY of the following occur:

1) **Post-completion defects**: User reports bugs after DoD was marked complete
2) **Process violations**: Any gate was bypassed or incorrectly marked satisfied
3) **Repeated friction**: Same issue occurs across multiple work items
4) **User questions process**: User asks "why didn't X happen?" about workflow

When auto-triggered, Copilot must:
1) Acknowledge the trigger condition
2) State: "Triggering Retrospective role due to: <reason>"
3) Proceed with Retrospective role responsibilities
```

---

### Change 2: Update Developer Role for UI Verification

**File**: `.github/roles/developer.md`

**Replace existing "Success criteria" section with:**

```markdown
## UI Verification (for stories with visual components)

If the User Story includes UI/visual acceptance criteria:
1) After implementation, **ask Project Owner to run the application**
2) Request screenshot or verbal confirmation of visual elements
3) Do NOT mark DoD complete until Project Owner confirms visual acceptance
4) Document any visual issues reported and fix before proceeding

**Trigger phrases to recognize UI stories:**
- "displayed", "visible", "rendered", "shown", "appears"
- Any mention of colors, layout, fonts, buttons, screens

## Success criteria
- Tests pass locally/CI (or marked unverified with exact commands).
- Implementation matches acceptance criteria.
- **For UI stories**: Project Owner has visually verified the implementation.
```

---

### Change 3: Update DoD Checklist for Visual Verification

**File**: `.github/copilot-instructions.md`

**Update DoD Checklist in "Required status header" section:**

```markdown
- DoD Checklist:
  - [ ] Automated tests updated/added
  - [ ] All tests pass
  - [ ] Build passes
  - [ ] Run/deploy validated
  - [ ] Docs updated
  - [ ] Refactor pass complete
  - [ ] All artifacts in correct locations (repo root)
  - [ ] **Visual verification by Project Owner (if UI story)**
```

---

## Summary of Changes

| File | Change |
|------|--------|
| `.github/copilot-instructions.md` | Add "Retrospective auto-trigger rules" section |
| `.github/copilot-instructions.md` | Add visual verification to DoD checklist |
| `.github/roles/developer.md` | Add "UI Verification" section |
| `.github/roles/developer.md` | Update success criteria for UI stories |

---

## Next Steps

1. Review proposed changes with Project Owner
2. Apply approved changes to instruction files
3. Use updated process for future work items
